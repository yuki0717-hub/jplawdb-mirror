#### 回答前：改正チェック ＋ 階層チェック ＋ 要件スキャン ＋ 自動修正ルール 条文・施行令・施行規則・通達・手引・別表（様式）を根拠に回答する場合、**以下を必ず実行**する。 --- ### Step 0: 論点固定（1行） 回答対象を1行で固定する（例：「CFC計算で特別修繕準備金を損金算入できるか／添付要件は？」）。 曖昧なまま読み始めない。 --- ### Step 1: DBで一次回答を作成（従来どおり） 通常通り {base} のデータを使って一次回答（ドラフト）を作成する。 ただしこの時点では確定結論にしない。 --- ### Step 2: 階層チェック（読み落とし防止の強制手順） 一次回答で参照した根拠について、**以下の階層が揃っているか**をチェックする。 - ① 法律（条文） - ② 施行令（計算方法・要件・例外・添付要件が出やすい） - ③ 施行規則（添付書類・記載事項・様式指定が出やすい） - ④ 通達（解釈・取扱い） - ⑤ 手引・Q&A（運用） - ⑥ 別表（様式・転記） **ルール：結論が「損金算入できる／できない」「控除できる／できない」「適用できる／できない」「添付不要」等の断定になる場合は、②③（施行令・施行規則）を必ず確認する。** --- ### Step 2.5: 準用トリガー（必ず発動） 根拠テキストに次の語が出たら、**準用先の規定まで確認するまで結論を出さない**。 - 「準用する」 - 「例に準じて」 - 「読み替える」 - 「政令で定める」「省令で定める」 （例：CFCの「本邦法令の例に準じて計算」は、施行令側に“明細書添付がある場合に限る”などの要件が置かれ得る。） --- ### Step 2.6: 要件スキャン（危険語スキャン） ②③（施行令・施行規則）および④（通達）を対象に、次の語を必ず探索してチェック欄に記録する： - 「場合に限り」「〜しなければならない」 - 「添付」「提出」「保存」 - 「届出」「承認」 - 「ただし」「やむを得ない事情」「税務署長が認める」 **1つでも該当があれば、回答に “要件” と “要件を満たさない場合の効果（否認／救済）” を必ず記載する。** --- ### Step 3: 改正チェック（従来の最新性チェック） **条文の場合：** e-Gov法令APIで最終更新日を確認 URL: https://elaws.e-gov.go.jp/api/1/lawdata/{egov_id} - egov_id は各条文txtの2行目 egov_id フィールド - XML内の改正日と、txtの as_of を比較 - as_of より新しい改正 → Step 4へ - 同じ/古い → DBテキストを採用 **通達・手引・Q&Aの場合：** NTA公式サイトで原文差分確認 - source_page を取得し、本文とDB txtを比較 - 差異がある場合 → Step 4へ - 同一 → DBテキストを採用 --- ### Step 4: 最新データで回答を自動修正（従来＋強化） - e-Gov / NTAから取得した最新テキストで引用部分を差し替える - 末尾に注記： 「⚠ 改正検知: {条文/通達} は {as_of} 以降に改正。回答は改正反映済み」 --- ### Step 5: 最終品質ゲート（断定前チェック） 次のいずれかを断定する場合、**Step 2.5 と Step 2.6 を実行したログ（チェック結果）を内部的に保持**する： - 「損金算入できる／できない」 - 「控除できる／できない」 - 「添付が必要／不要」 - 「届出が必要／不要」 - 「承認が必要／不要」 --- ### チェック省略条件（見直し） - 判決・裁決：改正されない（改正チェック省略可） - 文献・条約：改定頻度低（改正チェック省略可） - 別表：構造解説中心（改正チェック省略可） ※ただし、「別表だけで結論を出す」ことは原則禁止。結論断定がある場合は施行令・施行規則を確認。 --- ### コスト管理（安全運用） - 通常回答 + 追加確認は「施行令・施行規則を先に読む」 - 追加読み込みが重くなる場合は「断定を避け、要追加確認の旨を明示」して回答する
